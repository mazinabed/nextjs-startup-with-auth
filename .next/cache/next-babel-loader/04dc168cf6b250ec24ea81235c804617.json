{"ast":null,"code":"import jwt from \"jsonwebtoken\";\nexport default function Auth(req, res) {\n  try {\n    const token = req.headers.authorization.split(' ')[1];\n    const result = jwt.verify(token, process.env.secretkey);\n    req.authorization = result;\n    return true;\n  } catch (e) {\n    // console.error(e);\n    res.status(401).send(\"You are not authorized\");\n    return false;\n  }\n}","map":{"version":3,"sources":["/Users/mazinabed/Desktop/nextjs-startup-with-auth/util/auth.js"],"names":["jwt","Auth","req","res","token","headers","authorization","split","result","verify","process","env","secretkey","e","status","send"],"mappings":"AAAA,OAAOA,GAAP,MAAgB,cAAhB;AACA,eAAe,SAASC,IAAT,CAAcC,GAAd,EAAmBC,GAAnB,EAAuB;AAClC,MAAG;AACC,UAAMC,KAAK,GAAGF,GAAG,CAACG,OAAJ,CAAYC,aAAZ,CAA0BC,KAA1B,CAAgC,GAAhC,EAAqC,CAArC,CAAd;AACA,UAAMC,MAAM,GAAGR,GAAG,CAACS,MAAJ,CAAWL,KAAX,EAAkBM,OAAO,CAACC,GAAR,CAAYC,SAA9B,CAAf;AACAV,IAAAA,GAAG,CAACI,aAAJ,GAAoBE,MAApB;AACA,WAAO,IAAP;AACH,GALD,CAKC,OAAMK,CAAN,EAAQ;AACL;AACAV,IAAAA,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,wBAArB;AACA,WAAO,KAAP;AACH;AACJ","sourcesContent":["import jwt from \"jsonwebtoken\"\nexport default function Auth(req, res){\n    try{\n        const token = req.headers.authorization.split(' ')[1]\n        const result = jwt.verify(token, process.env.secretkey);\n        req.authorization = result;\n        return true\n    }catch(e){\n        // console.error(e);\n        res.status(401).send(\"You are not authorized\")\n        return false\n    }\n}\n"]},"metadata":{},"sourceType":"module"}